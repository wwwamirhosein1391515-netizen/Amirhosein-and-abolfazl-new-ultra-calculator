<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amirhosein and abolfazl Ultra Calculator</title>
    <!-- لود کردن Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        // افزودن فونت‌های فارسی
                        sans: ['Inter', 'Tahoma', 'Vazirmatn', 'sans-serif'],
                    },
                    colors: {
                        'dark-text': '#1F2937',     
                    },
                    boxShadow: {
                        'liquid-glow': '0 0 30px rgba(139, 92, 246, 0.5)',
                    }
                }
            }
        }
    </script>
    <style>
        /* پس‌زمینه رنگارنگ و زنده با تغییر ملایم */
        body {
            /* تغییر گرادینت به رنگ‌های زنده‌تر و متنوع‌تر */
            background: linear-gradient(-45deg, #FFDEE9, #B5FFFC, #E0C3FC, #fff1eb);
            background-size: 400% 400%;
            animation: gradient-shift 15s ease infinite;
            min-height: 100vh;
        }
        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* HYPER LIQUID GLASS EFFECT (افزایش شدید شفافیت و بلور) */
        .glass-panel {
            /* بلور بسیار شدید و شفافیت بالا */
            background: rgba(255, 255, 255, 0.1); 
            backdrop-filter: blur(70px); 
            -webkit-backdrop-filter: blur(70px);
            border: 1px solid rgba(255, 255, 255, 0.6); /* مرز مشخص‌تر برای جلوه شیشه‌ای */
            box-shadow: 0 15px 50px 0 rgba(31, 38, 135, 0.3); /* سایه عمیق‌تر */
            border-radius: 4rem; /* گردی بیشتر */
        }

        /* کادرهای داخلی - Liquid Pill (محل قرارگیری ورودی‌ها) */
        .liquid-pill {
            /* بلور و شفافیت بالا */
            background: rgba(255, 255, 255, 0.1); 
            box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.2); 
            border: 1px solid rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(20px); 
            border-radius: 3rem; 
            padding: 1.5rem;
            transition: all 0.4s ease;
        }
        
        /* ورودی‌ها: مهم‌ترین اصلاح برای شیشه‌ای کردن کامل */
        .glass-input {
            /* ورودی‌های کاملاً شفاف */
            @apply w-full text-center font-bold outline-none placeholder-gray-500/80 py-2 px-3 transition-all duration-300;
            background: rgba(255, 255, 255, 0.1); 
            border: 1px solid rgba(255, 255, 255, 0.4); 
            border-radius: 2rem;
            color: #1F2937;
            box-shadow: inset 0 1px 8px rgba(0, 0, 0, 0.15);
        }
        .glass-input:focus {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(139, 92, 246, 0.7);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.4);
        }

        /* دکمه‌های ماشین حساب - حباب‌های شیشه‌ای */
        .calc-btn {
            @apply flex items-center justify-center text-xl font-bold transition-all active:scale-90 shadow-2xl;
            height: 4.5rem; 
            border-radius: 9999px; 
            background: rgba(255, 255, 255, 0.2); 
            border: 1px solid rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(15px);
            color: #374151;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.7);
        }
        .calc-btn:hover {
            background: rgba(255, 255, 255, 0.35);
            box-shadow: 0 0 25px rgba(139, 92, 246, 0.4);
        }

        /* رنگ‌بندی دکمه‌ها */
        .btn-op {
            background: rgba(6, 182, 212, 0.35); /* کمی شفاف‌تر */
            color: #0891b2;
            border-color: rgba(6, 182, 212, 0.6);
        }
        .btn-ac {
            background: rgba(244, 114, 182, 0.35); /* کمی شفاف‌تر */
            color: #be185d;
            border-color: rgba(244, 114, 182, 0.6);
        }
        .btn-eq {
            background: rgba(139, 92, 246, 0.5); /* کمی شفاف‌تر */
            color: #4c1d95;
            border-color: rgba(139, 92, 246, 0.7);
            font-size: 1.6rem;
        }

        /* نمایشگر اصلی */
        #display-screen {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: inset 0 2px 15px rgba(0,0,0,0.1);
            border-radius: 3rem;
            backdrop-filter: blur(30px);
        }
        
        /* تب‌ها - Ultra-Clean Styling (جداسازی جعبه‌ها) */
        .tab-pill {
            /* استفاده از استایل شیشه‌ای قوی برای جعبه‌های جداگانه */
            @apply py-3 text-sm font-bold rounded-[2rem] transition-all text-gray-700/90 shadow-lg;
            background: rgba(255, 255, 255, 0.1); 
            border: 1px solid rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(15px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            line-height: 1.25; /* کنترل ارتفاع خط */
        }

        .tab-pill-active {
            /* تم رنگی بنفش قوی‌تر برای تب فعال */
            background: rgba(139, 92, 246, 0.3); /* پس زمینه بنفش شفاف */
            color: #4c1d95;
            border-color: rgba(139, 92, 246, 0.7);
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.5);
        }

        .fraction-line {
            @apply border-b-2 border-gray-500/60 w-full my-1;
        }
    </style>
</head>

<body class="text-dark-text overflow-x-hidden selection:bg-purple-300 selection:text-purple-900">

    <!-- هدر با Liquid OS 100.0 و باکس عنوان (مشابه عکس) -->
    <header class="p-4 flex flex-col justify-center items-center max-w-sm mx-auto mt-2 opacity-100">
        <!-- Liquid OS 100.0 - Separate Pill -->
        <span class="text-sm font-mono bg-white/30 px-4 py-1 rounded-full border border-white/40 shadow-xl text-purple-700 font-extrabold mb-4">Liquid OS 100.0</span>
        
        <!-- Main Title in a distinct Glass Card (استفاده از glass-panel) -->
        <div class="glass-panel text-2xl font-extrabold text-gray-800 drop-shadow-md text-center py-3 px-6 mb-6">
            Amirhosein and abolfazl Ultra Calculator
        </div>
    </header>

    <!-- کانتینر اصلی -->
    <main class="flex justify-center items-start pt-4 pb-20 px-4 min-h-[70vh]">
        
        <!-- پنل اصلی شیشه‌ای -->
        <div class="glass-panel w-full max-w-sm p-7 relative overflow-hidden">
            
            <!-- حباب‌های نورانی پس‌زمینه -->
            <div class="absolute -top-10 -right-10 w-40 h-40 bg-purple-300/40 rounded-full blur-3xl pointer-events-none opacity-70"></div>
            <div class="absolute top-52 -left-10 w-52 h-52 bg-blue-300/30 rounded-full blur-3xl pointer-events-none opacity-60"></div>

            <h2 class="text-2xl font-extrabold text-center mb-6 text-gray-800/90 drop-shadow-md">ابزارهای هایپر شفاف</h2>
            
            <!-- تب بار جدید با جعبه‌های جداگانه -->
            <div class="grid grid-cols-2 gap-3 mb-6">
                <button onclick="changeTab('basic')" id="tab-basic" class="tab-pill">پایه</button>
                <button onclick="changeTab('fraction')" id="tab-fraction" class="tab-pill">کسر</button>
                <button onclick="changeTab('root')" id="tab-root" class="tab-pill">توان و ریشه</button>
                <button onclick="changeTab('equation')" id="tab-equation" class="tab-pill">معادلات پیشرفته</button>
            </div>

            <div id="app-content" class="relative z-10 transition-all duration-300">
                <!-- محتوا -->
            </div>

        </div>
    </main>
    
    <script>
        // توابع کمکی
        const getV = (id) => { 
            const el = document.getElementById(id);
            if (!el) return NaN;
            const v = el.value.trim(); 
            // اگر خالی بود ۰ در نظر می‌گیرد، در غیر این صورت فلوت
            return v === '' ? 0 : parseFloat(v); 
        };

        document.addEventListener('DOMContentLoaded', () => changeTab('basic'));

        function changeTab(tabName) {
            ['basic', 'fraction', 'root', 'equation'].forEach(tab => {
                const btn = document.getElementById(`tab-${tab}`);
                if(btn) {
                    // حذف کلاس‌های قدیمی و اضافه کردن کلاس پایه جدید
                    btn.classList.remove('tab-pill-active');
                    btn.classList.add('tab-pill'); 
                    
                    if (tab === tabName) {
                        btn.classList.add('tab-pill-active');
                    }
                }
            });

            const contentDiv = document.getElementById('app-content');
            contentDiv.style.opacity = '0';
            
            setTimeout(() => {
                contentDiv.innerHTML = '';
                if (tabName === 'basic') renderBasic();
                else if (tabName === 'fraction') renderFraction();
                else if (tabName === 'root') renderRoot();
                else if (tabName === 'equation') renderEquation();
                contentDiv.style.opacity = '1';
            }, 150);
        }

        /* --- 1. Basic Calculator --- */
        let displayVal = '0', prevVal = null, op = null, wait = true;

        function renderBasic() {
            const container = document.getElementById('app-content');
            // ری‌رندر کردن دیسپلی برای اطمینان از نمایش صحیح
            container.innerHTML = `
                <div class="flex flex-col gap-5">
                    <div id="display-screen" class="p-5 text-right text-4xl font-mono text-gray-800 break-all min-h-[5.5rem] flex items-center justify-end shadow-inner">
                        ${displayVal}
                    </div>
                    
                    <div class="grid grid-cols-4 gap-3">
                        <button onclick="handleClr()" class="calc-btn btn-ac">AC</button>
                        <button onclick="handleOp('/')" class="calc-btn btn-op">÷</button>
                        <button onclick="handleOp('*')" class="calc-btn btn-op">×</button>
                        <button onclick="handleOp('-')" class="calc-btn btn-op">-</button>

                        <button onclick="handleNum(7)" class="calc-btn">7</button>
                        <button onclick="handleNum(8)" class="calc-btn">8</button>
                        <button onclick="handleNum(9)" class="calc-btn">9</button>
                        <button onclick="handleOp('+')" class="calc-btn btn-op">+</button>

                        <button onclick="handleNum(4)" class="calc-btn">4</button>
                        <button onclick="handleNum(5)" class="calc-btn">5</button>
                        <button onclick="handleNum(6)" class="calc-btn">6</button>
                        <button onclick="handleEq()" class="calc-btn btn-eq row-span-2">=</button>

                        <button onclick="handleNum(1)" class="calc-btn">1</button>
                        <button onclick="handleNum(2)" class="calc-btn">2</button>
                        <button onclick="handleNum(3)" class="calc-btn">3</button>

                        <button onclick="handleNum(0)" class="calc-btn col-span-2">0</button>
                        <button onclick="handleDot()" class="calc-btn">.</button>
                    </div>
                </div>
            `;
            updateScreen();
        }
        
        // Logic for Basic Calc
        function updateScreen() {
            const el = document.getElementById('display-screen');
            if(el) el.innerText = displayVal.length > 15 ? parseFloat(displayVal).toExponential(4) : displayVal;
        }
        function handleNum(n) {
            if(wait) { displayVal = String(n); wait = false; }
            else displayVal = displayVal === '0' ? String(n) : displayVal + n;
            updateScreen();
        }
        function handleDot() {
            if(wait) { displayVal = '0.'; wait = false; }
            else if(!displayVal.includes('.')) displayVal += '.';
            updateScreen();
        }
        function handleOp(o) {
            const val = parseFloat(displayVal);
            if(prevVal === null) prevVal = val;
            else if(op) prevVal = calc(prevVal, val, op);
            op = o; wait = true; displayVal = String(prevVal); updateScreen();
        }
        function handleEq() {
            if(op && prevVal !== null) {
                prevVal = calc(prevVal, parseFloat(displayVal), op);
                op = null; wait = true; displayVal = String(prevVal); updateScreen();
                prevVal = null;
            }
        }
        function handleClr() {
            displayVal = '0'; prevVal = null; op = null; wait = true; updateScreen();
        }
        function calc(a, b, o) {
            if(o === '+') return a+b; if(o === '-') return a-b;
            if(o === '*') return a*b; if(o === '/') return b!==0 ? a/b : 'Error';
            return b;
        }

        /* --- 2. Advanced Equation Solver (Linear, Two-Var, Fractional, QUADRATIC) --- */
        let currentEqMode = 'linear';

        function renderEquation() {
            const container = document.getElementById('app-content');
            container.innerHTML = `
                <div class="flex flex-col gap-4">
                    <!-- Liquid Pill برای تب‌های داخلی -->
                    <div class="liquid-pill flex p-1.5 rounded-[2rem] border border-white/20 backdrop-blur-md">
                        <button onclick="eqMode('linear')" id="mod-linear" class="flex-1 py-2 text-xs rounded-2xl transition-all">1 مجهولی</button>
                        <button onclick="eqMode('two-var')" id="mod-two-var" class="flex-1 py-2 text-xs rounded-2xl transition-all">2 مجهولی</button>
                        <button onclick="eqMode('quadratic')" id="mod-quadratic" class="flex-1 py-2 text-xs rounded-2xl transition-all">درجه دوم</button>
                        <button onclick="eqMode('fractional')" id="mod-fractional" class="flex-1 py-2 text-xs rounded-2xl transition-all">کسری</button>
                    </div>
                    <div id="eq-panel"></div>
                </div>
            `;
            eqMode(currentEqMode);
        }

        function eqMode(m) {
            currentEqMode = m;
            const panel = document.getElementById('eq-panel');
            
            // تعیین استایل دکمه فعال
            ['linear', 'two-var', 'fractional', 'quadratic'].forEach(mode => {
                const btn = document.getElementById(`mod-${mode}`);
                if (!btn) return;
                if (mode === m) {
                    // استایل شیشه‌ای فعال با رنگ بنفش
                    btn.className = "flex-1 py-2 text-xs rounded-2xl bg-white/40 text-purple-800 font-extrabold shadow-lg transition-all";
                } else {
                    btn.className = "flex-1 py-2 text-xs rounded-2xl text-gray-700/80 hover:bg-white/10 transition-all";
                }
            });

            if (m === 'linear') {
                // ax + b = c
                panel.innerHTML = `
                    <div class="liquid-pill flex items-center justify-center gap-2 mb-4 p-4">
                        <input type="number" id="l-a" class="glass-input w-12 text-base" placeholder="a">
                        <span class="text-gray-600 text-lg">x +</span>
                        <input type="number" id="l-b" class="glass-input w-12 text-base" placeholder="b">
                        <span class="text-gray-600 text-lg">=</span>
                        <input type="number" id="l-c" class="glass-input w-12 text-base" placeholder="c">
                    </div>
                    <button onclick="solveLin()" class="calc-btn btn-eq w-full text-lg mb-4 shadow-xl">محاسبه x</button>
                    <div id="res-lin" class="text-center font-bold text-lg text-purple-800 h-8"></div>
                `;
            } else if (m === 'two-var') {
                // ax + by = c, dx + ey = f
                panel.innerHTML = `
                    <div class="liquid-pill flex flex-col gap-3 p-4">
                        <h4 class="text-sm font-semibold text-gray-700 mb-2 text-center border-b border-white/20 pb-2">دستگاه معادلات خطی (کرامر)</h4>
                        
                        <!-- معادله اول -->
                        <div class="flex items-center justify-center gap-2" dir="ltr">
                            <input type="number" id="t-a" class="glass-input w-10 text-base" placeholder="a">
                            <span class="text-gray-600 text-sm">x +</span>
                            <input type="number" id="t-b" class="glass-input w-10 text-base" placeholder="b">
                            <span class="text-gray-600 text-sm">y =</span>
                            <input type="number" id="t-c" class="glass-input w-10 text-base" placeholder="c">
                        </div>

                        <div class="h-px bg-white/30 my-1"></div>

                        <!-- معادله دوم -->
                        <div class="flex items-center justify-center gap-2" dir="ltr">
                            <input type="number" id="t-d" class="glass-input w-10 text-base" placeholder="d">
                            <span class="text-gray-600 text-sm">x +</span>
                            <input type="number" id="t-e" class="glass-input w-10 text-base" placeholder="e">
                            <span class="text-gray-600 text-sm">y =</span>
                            <input type="number" id="t-f" class="glass-input w-10 text-base" placeholder="f">
                        </div>
                    </div>
                    <button onclick="solveTwoVar()" class="calc-btn btn-eq w-full text-lg mt-4 shadow-xl">حل دستگاه</button>
                    <div id="res-two-var" class="text-center font-bold text-lg text-purple-800 h-16 mt-2"></div>
                `;
            } else if (m === 'quadratic') {
                // ax^2 + bx + c = 0
                panel.innerHTML = `
                    <div class="liquid-pill flex items-center justify-center gap-2 mb-4 p-4">
                        <input type="number" id="q-a" class="glass-input w-12 text-base" placeholder="a">
                        <span class="text-gray-600 text-lg">x² +</span>
                        <input type="number" id="q-b" class="glass-input w-12 text-base" placeholder="b">
                        <span class="text-gray-600 text-lg">x +</span>
                        <input type="number" id="q-c" class="glass-input w-12 text-base" placeholder="c">
                        <span class="text-gray-600 text-lg">= 0</span>
                    </div>
                    <button onclick="solveQuadratic()" class="calc-btn btn-eq w-full text-lg mb-4 shadow-xl">محاسبه ریشه‌ها</button>
                    <div id="res-quad" class="liquid-pill min-h-[6rem] flex flex-col items-center justify-center text-gray-700 font-bold text-base space-y-2">
                        <span class="text-gray-500 text-sm">نتیجه ($\Delta$) و ریشه‌ها</span>
                    </div>
                `;
            } else {
                // Fractional Equation: (ax+b)/c = (dx+e)/f
                panel.innerHTML = `
                    <div class="liquid-pill mb-4 flex flex-col items-center p-4">
                        <h4 class="text-sm font-semibold text-gray-700 mb-4 text-center border-b border-white/20 pb-2">معادله کسری (طرفین وسطین)</h4>
                        <div class="flex items-center gap-3 w-full justify-center" dir="ltr">
                            <div class="flex flex-col w-20 items-center">
                                <div class="flex items-center gap-1">
                                    <input id="f-a" class="glass-input text-base text-center p-0 h-8 w-8" placeholder="a">
                                    <span class="text-gray-500 text-xs">x+</span>
                                    <input id="f-b" class="glass-input text-base text-center p-0 h-8 w-8" placeholder="b">
                                </div>
                                <div class="fraction-line"></div>
                                <input id="f-c" class="glass-input text-base text-center p-0 h-8 w-16" placeholder="c">
                            </div>
                            <span class="text-xl text-gray-600">=</span>
                            <div class="flex flex-col w-20 items-center">
                                <div class="flex items-center gap-1">
                                    <input id="f-d" class="glass-input text-base text-center p-0 h-8 w-8" placeholder="d">
                                    <span class="text-gray-500 text-xs">x+</span>
                                    <input id="f-e" class="glass-input text-base text-center p-0 h-8 w-8" placeholder="e">
                                </div>
                                <div class="fraction-line"></div>
                                <input id="f-f" class="glass-input text-base text-center p-0 h-8 w-16" placeholder="f">
                            </div>
                        </div>
                    </div>
                    <button onclick="solveFracEq()" class="calc-btn btn-eq w-full text-lg mb-4 shadow-xl">حل (طرفین وسطین)</button>
                    <div id="res-frac" class="text-center font-bold text-lg text-purple-800 h-8"></div>
                `;
            }
        }
        
        function solveLin() {
            const a = getV('l-a');
            const b = getV('l-b');
            const c = getV('l-c');
            const res = document.getElementById('res-lin');
            if(isNaN(a) || isNaN(b) || isNaN(c)) { res.innerText = "لطفاً هر سه عدد را وارد کنید"; return; }
            if(a===0) res.innerText = "ضریب x (a) نمی‌تواند ۰ باشد";
            else res.innerText = `x = ${((c-b)/a).toFixed(4)}`;
        }

        function solveTwoVar() {
            const a=getV('t-a'), b=getV('t-b'), c=getV('t-c');
            const d=getV('t-d'), e=getV('t-e'), f=getV('t-f');
            const res = document.getElementById('res-two-var');

            if(isNaN(a) || isNaN(b) || isNaN(c) || isNaN(d) || isNaN(e) || isNaN(f)) { 
                res.innerHTML = "لطفاً همه ضرایب را وارد کنید."; return; 
            }
            
            const D = (a * e) - (b * d);
            const Dx = (c * e) - (b * f);
            const Dy = (a * f) - (c * d);

            if (D === 0) {
                if (Dx === 0 && Dy === 0) {
                    res.innerHTML = '<span class="text-green-700">بینهایت جواب</span><br><span class="text-xs">دو خط منطبق بر هم هستند.</span>';
                } else {
                    res.innerHTML = '<span class="text-red-700">بدون جواب</span><br><span class="text-xs">دو خط موازی هستند.</span>';
                }
            } else {
                const x = Dx / D;
                const y = Dy / D;
                res.innerHTML = `<div>x = ${x.toFixed(4)}</div><div>y = ${y.toFixed(4)}</div>`;
            }
        }

        function solveQuadratic() {
            const a = getV('q-a');
            const b = getV('q-b');
            const c = getV('q-c');
            const res = document.getElementById('res-quad');

            if(isNaN(a) || isNaN(b) || isNaN(c)) { 
                res.innerHTML = '<span class="text-red-600">لطفاً هر سه ضریب را وارد کنید.</span>'; return; 
            }

            if (a === 0) {
                res.innerHTML = '<span class="text-red-600">معادله خطی است (a نمی‌تواند ۰ باشد).</span>';
                return;
            }

            // محاسبه دلتا
            const delta = (b * b) - (4 * a * c);
            let resultHTML = `<div class="font-mono text-xl">$\Delta$ = ${delta.toFixed(4)}</div>`;

            if (delta > 0) {
                // دو ریشه حقیقی
                const x1 = (-b + Math.sqrt(delta)) / (2 * a);
                const x2 = (-b - Math.sqrt(delta)) / (2 * a);
                resultHTML += `<div class="text-green-700 mt-2">دو ریشه حقیقی مجزا:</div>`;
                resultHTML += `<div>x\u2081 = ${x1.toFixed(4)}</div>`;
                resultHTML += `<div>x\u2082 = ${x2.toFixed(4)}</div>`; // \u2081 و \u2082 زیرنویس هستند
            } else if (delta === 0) {
                // یک ریشه مضاعف
                const x = -b / (2 * a);
                resultHTML += `<div class="text-yellow-700 mt-2">یک ریشه حقیقی مضاعف:</div>`;
                resultHTML += `<div>x = ${x.toFixed(4)}</div>`;
            } else {
                // دو ریشه مختلط
                const realPart = (-b / (2 * a)).toFixed(4);
                const imagPart = (Math.sqrt(-delta) / (2 * a)).toFixed(4);
                
                resultHTML += `<div class="text-blue-700 mt-2">دو ریشه مختلط:</div>`;
                resultHTML += `<div>x\u2081 = ${realPart} + ${imagPart}i</div>`;
                resultHTML += `<div>x\u2082 = ${realPart} - ${imagPart}i</div>`;
            }

            res.innerHTML = resultHTML;
        }


        function solveFracEq() {
            const a=getV('f-a'), b=getV('f-b');
            const c = getV('f-c');
            const d=getV('f-d'), e=getV('f-e');
            const f = getV('f-f');
            const res = document.getElementById('res-frac');
            
            if(isNaN(a) || isNaN(b) || isNaN(c) || isNaN(d) || isNaN(e) || isNaN(f)) { 
                res.innerText = "لطفاً همه ضرایب را وارد کنید"; return; 
            }
            if(c===0 || f===0) { res.innerText = "مخرج صفر ممنوع است!"; return; }
            
            // پیاده‌سازی طرفین وسطین: f(ax+b) = c(dx+e)
            // fax + fb = cdx + ce
            // (fa - cd)x = ce - fb
            const X_coef = (f*a) - (c*d);
            const N_const = (c*e) - (f*b);
            
            if(X_coef===0) res.innerText = N_const===0 ? "همه اعداد (نامعین)" : "بدون جواب (متناقض)";
            else res.innerText = `x = ${(N_const/X_coef).toFixed(4)}`;
        }

        /* --- 3. Fraction Calc --- */
        function renderFraction() {
            const c = document.getElementById('app-content');
            c.innerHTML = `
                <div class="flex flex-col gap-6">
                    <!-- Liquid Pill با ورودی‌های کاملاً شفاف شده -->
                    <div class="liquid-pill flex items-center justify-center gap-2 p-4" dir="ltr">
                        <div class="flex flex-col w-20 items-center">
                            <input id="fr1-n" class="glass-input h-8 text-base text-center p-0" placeholder="صورت">
                            <div class="fraction-line"></div>
                            <input id="fr1-d" class="glass-input h-8 text-base text-center p-0" placeholder="مخرج">
                        </div>
                        <select id="fr-op" class="bg-white/10 font-extrabold text-xl text-purple-700 border border-white/40 rounded-full p-2 outline-none cursor-pointer shadow-md transition-all hover:bg-white/30">
                            <option value="+">+</option><option value="-">-</option>
                            <option value="*">×</option><option value="/">÷</option>
                        </select>
                        <div class="flex flex-col w-20 items-center">
                            <input id="fr2-n" class="glass-input h-8 text-base text-center p-0" placeholder="صورت">
                            <div class="fraction-line"></div>
                            <input id="fr2-d" class="glass-input h-8 text-base text-center p-0" placeholder="مخرج">
                        </div>
                    </div>
                    <button onclick="doFrac()" class="calc-btn btn-eq w-full text-lg shadow-xl">محاسبه کسر</button>
                    <div id="fr-res" class="liquid-pill min-h-[4rem] flex items-center justify-center text-gray-800 font-bold text-lg shadow-inner">...</div>
                </div>
            `;
        }
        function doFrac() {
            const v = (id) => parseFloat(document.getElementById(id).value);
            const n1=v('fr1-n'), d1=v('fr1-d'), n2=v('fr2-n'), d2=v('fr2-d');
            const op = document.getElementById('fr-op').value;
            const r = document.getElementById('fr-res');
            
            if(isNaN(n1) || isNaN(d1) || isNaN(n2) || isNaN(d2)) { r.innerText = "اعداد ناقص هستند"; return; }
            if(d1===0 || d2===0) { r.innerText = "مخرج صفر ممنوع!"; return; }
            
            let rn, rd;
            if(op==='+'){ rn=n1*d2 + n2*d1; rd=d1*d2; }
            else if(op==='-'){ rn=n1*d2 - n2*d1; rd=d1*d2; }
            else if(op==='*'){ rn=n1*n2; rd=d1*d2; }
            else { if(n2===0){r.innerText="خطای تقسیم بر صفر"; return;} rn=n1*d2; rd=d1*n2; }
            
            const g = (a,b) => b===0?a:g(b,a%b);
            const cd = g(Math.abs(rn), Math.abs(rd));
            
            const simplifiedN = rn/cd;
            const simplifiedD = rd/cd;

            if (simplifiedD === 1) {
                r.innerHTML = `<span class="text-3xl text-purple-800">${simplifiedN}</span>`;
            } else {
                r.innerHTML = `
                    <div class="flex flex-col items-center">
                        <span class="text-2xl border-b-2 border-purple-500 px-3 pb-1">${simplifiedN}</span>
                        <span class="text-xl pt-1">${simplifiedD}</span>
                    </div>
                `;
            }
        }

        /* --- 4. Root/Power Calc --- */
        function renderRoot() {
            const c = document.getElementById('app-content');
            c.innerHTML = `
                <div class="flex flex-col gap-6">
                    <!-- Liquid Pill با ورودی کاملاً شفاف شده -->
                    <div class="liquid-pill text-center p-5">
                        <input id="rp-in" type="number" class="glass-input py-3 text-2xl placeholder-gray-400" placeholder="عدد اصلی را وارد کنید">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <button onclick="doRP()" class="calc-btn btn-eq shadow-liquid-glow">محاسبه توان و ریشه</button>
                        <button onclick="document.getElementById('rp-in').value=''" class="calc-btn btn-ac">پاک کردن</button>
                    </div>
                    <!-- Liquid Pill برای نتایج -->
                    <div id="rp-out" class="liquid-pill min-h-[6rem] flex flex-col items-center justify-center font-mono text-gray-800 font-bold text-lg space-y-3 shadow-inner">
                        <span class="text-gray-500 text-sm">نتایج شامل جذر و توان در اینجا نمایش داده می‌شود</span>
                    </div>
                </div>
            `;
        }
        function doRP() {
            const val = parseFloat(document.getElementById('rp-in').value);
            const out = document.getElementById('rp-out');
            if(isNaN(val)) { out.innerHTML = `<span class="text-red-600">ورودی نامعتبر است.</span>`; return; }
            
            const sqrtResult = val < 0 ? 'خطا (عدد منفی)' : Math.sqrt(val).toFixed(6);

            out.innerHTML = `
                <div class="flex items-center space-x-3 text-2xl" dir="ltr">
                    <span class="text-purple-600">√(${val})</span>
                    <span class="text-gray-500">=</span>
                    <span class="text-gray-800">${sqrtResult}</span>
                </div>
                <div class="flex items-center space-x-3 text-2xl" dir="ltr">
                    <span class="text-purple-600">${val}²</span>
                    <span class="text-gray-500">=</span>
                    <span class="text-gray-800">${(val*val).toFixed(6)}</span>
                </div>
            `;
        }
    </script>
</body>
</html>

